2025-05-22 03:16:09,678 - root - INFO - app_logger:89 - Logging to file: /app/yield_curve_rv_strategy/logs/data_cleaner_test.log at level DEBUG
2025-05-22 03:16:09,678 - root - INFO - app_logger:105 - Logging system (re)configured. Root logger level: DEBUG.
2025-05-22 03:16:09,678 - __main__ - INFO - data_cleaner:224 - --- Running data_cleaner.py tests ---
2025-05-22 03:16:09,684 - __main__ - INFO - data_cleaner:247 - --- Test 1: Merging data_dict ---
2025-05-22 03:16:09,685 - __main__ - DEBUG - data_cleaner:151 - Renamed 'value' column in source 'seriesA' to 'seriesA'.
2025-05-22 03:16:09,686 - __main__ - DEBUG - data_cleaner:155 - Renamed column 'seriesB_val' in source 'seriesB' to 'seriesB'.
2025-05-22 03:16:09,686 - __main__ - INFO - data_cleaner:168 - Merging 3 DataFrames using 'outer' strategy.
2025-05-22 03:16:09,690 - __main__ - INFO - data_cleaner:182 - Resampling merged DataFrame to frequency: B
2025-05-22 03:16:09,692 - __main__ - INFO - data_cleaner:188 - Merged DataFrame shape: (6, 7)
2025-05-22 03:16:09,706 - __main__ - INFO - data_cleaner:256 - Merged data (resampled to 'B'):
            seriesA  seriesB  ZN_F_Open  ...  ZN_F_Low  ZN_F_Close  ZN_F_Volume
2022-12-30      NaN      NaN        NaN  ...       NaN         NaN          NaN
2023-01-02      NaN     10.0      101.0  ...     100.0       102.0       1200.0
2023-01-03      3.0     11.0      102.0  ...     101.0       101.5       1100.0
2023-01-04      4.0      NaN      103.0  ...     102.0       103.5       1300.0
2023-01-05      5.5      NaN        NaN  ...       NaN         NaN          NaN
2023-01-06      NaN     13.0        NaN  ...       NaN         NaN          NaN

[6 rows x 7 columns]
2025-05-22 03:16:09,706 - __main__ - INFO - data_cleaner:260 - --- Test 2: Aligning dates and ffilling merged data ---
2025-05-22 03:16:09,707 - __main__ - INFO - data_cleaner:198 - Aligning dates and forward-filling. Initial shape: (6, 7). Ffill limit: 1
2025-05-22 03:16:09,707 - __main__ - INFO - data_cleaner:211 - Forward-filled data. Shape after ffill: (6, 7)
2025-05-22 03:16:09,717 - __main__ - INFO - data_cleaner:262 - Aligned and ffilled data:
            seriesA  seriesB  ZN_F_Open  ...  ZN_F_Low  ZN_F_Close  ZN_F_Volume
2022-12-30      NaN      NaN        NaN  ...       NaN         NaN          NaN
2023-01-02      NaN     10.0      101.0  ...     100.0       102.0       1200.0
2023-01-03      3.0     11.0      102.0  ...     101.0       101.5       1100.0
2023-01-04      4.0     11.0      103.0  ...     102.0       103.5       1300.0
2023-01-05      5.5      NaN      103.0  ...     102.0       103.5       1300.0
2023-01-06      5.5     13.0        NaN  ...       NaN         NaN          NaN

[6 rows x 7 columns]
2025-05-22 03:16:09,717 - __main__ - INFO - data_cleaner:269 - --- Test 3: Cleaning aligned data ---
2025-05-22 03:16:09,717 - __main__ - INFO - data_cleaner:32 - Starting data cleaning. Initial shape: (6, 7)
2025-05-22 03:16:09,718 - __main__ - DEBUG - data_cleaner:67 - Interpolating with method: linear
2025-05-22 03:16:09,722 - __main__ - DEBUG - data_cleaner:78 - Forward-filling NaNs with limit: 1
2025-05-22 03:16:09,722 - __main__ - DEBUG - data_cleaner:84 - Backward-filling NaNs with limit: 1
2025-05-22 03:16:09,723 - __main__ - INFO - data_cleaner:88 - NaNs handled: 14 initial -> 0 final.
2025-05-22 03:16:09,723 - __main__ - DEBUG - data_cleaner:93 - Applying outlier clipping at 2.0 std devs.
2025-05-22 03:16:09,734 - __main__ - INFO - data_cleaner:116 - Data cleaning finished. Final shape: (6, 7)
2025-05-22 03:16:09,745 - __main__ - INFO - data_cleaner:278 - Cleaned data:
            seriesA  seriesB  ZN_F_Open  ...  ZN_F_Low  ZN_F_Close  ZN_F_Volume
2022-12-30      3.0     10.0      101.0  ...     100.0       102.0       1200.0
2023-01-02      3.0     10.0      101.0  ...     100.0       102.0       1200.0
2023-01-03      3.0     11.0      102.0  ...     101.0       101.5       1100.0
2023-01-04      4.0     11.0      103.0  ...     102.0       103.5       1300.0
2023-01-05      5.5     12.0      103.0  ...     102.0       103.5       1300.0
2023-01-06      5.5     13.0      103.0  ...     102.0       103.5       1300.0

[6 rows x 7 columns]
2025-05-22 03:16:09,745 - __main__ - INFO - data_cleaner:280 - --- Test 3.1: Cleaning data with more NaNs to show interpolation ---
2025-05-22 03:16:09,746 - __main__ - INFO - data_cleaner:32 - Starting data cleaning. Initial shape: (5, 1)
2025-05-22 03:16:09,747 - __main__ - DEBUG - data_cleaner:67 - Interpolating with method: linear
2025-05-22 03:16:09,749 - __main__ - DEBUG - data_cleaner:78 - Forward-filling NaNs with limit: unlimited
2025-05-22 03:16:09,749 - __main__ - INFO - data_cleaner:88 - NaNs handled: 3 initial -> 0 final.
2025-05-22 03:16:09,749 - __main__ - INFO - data_cleaner:116 - Data cleaning finished. Final shape: (5, 1)
2025-05-22 03:16:09,752 - __main__ - INFO - data_cleaner:284 - Interpolated data (linear then unlimited ffill):
            val
2023-01-01  1.0
2023-01-02  2.0
2023-01-03  3.0
2023-01-04  4.0
2023-01-05  5.0
2025-05-22 03:16:09,752 - __main__ - INFO - data_cleaner:289 - --- data_cleaner.py tests complete ---
